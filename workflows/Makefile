# SPDX-License-Identifier: copyleft-next-0.3.1

# How we create the partition for the workflow data partition
WORKFLOW_DATA_DEVICE:=$(subst ",,$(CONFIG_WORKFLOW_DATA_DEVICE))
WORKFLOW_DATA_PATH:=$(subst ",,$(CONFIG_WORKFLOW_DATA_PATH))
WORKFLOW_DATA_FSTYPE:=$(subst ",,$(CONFIG_WORKFLOW_DATA_FSTYPE))
WORKFLOW_DATA_LABEL:=$(subst ",,$(CONFIG_WORKFLOW_DATA_LABEL))

WORKFLOW_KDEVOPS_GIT:=$(subst ",,$(CONFIG_WORKFLOW_KDEVOPS_GIT))
WORKFLOW_KDEVOPS_GIT_DATA:=$(subst ",,$(CONFIG_WORKFLOW_KDEVOPS_GIT_DATA))
WORKFLOW_KDEVOPS_DIR:=$(subst ",,$(CONFIG_WORKFLOW_KDEVOPS_DIR))

WORKFLOW_ARGS	+= data_device=$(WORKFLOW_DATA_DEVICE)
WORKFLOW_ARGS	+= data_path=$(WORKFLOW_DATA_PATH)
WORKFLOW_ARGS	+= data_fstype=$(WORKFLOW_DATA_FSTYPE)
WORKFLOW_ARGS	+= data_label=$(WORKFLOW_DATA_LABEL)
WORKFLOW_ARGS	+= kdevops_git=$(WORKFLOW_KDEVOPS_GIT)
WORKFLOW_ARGS	+= kdevops_data=\"$(WORKFLOW_KDEVOPS_GIT_DATA)\"
WORKFLOW_ARGS	+= kdevops_dir=\"$(WORKFLOW_KDEVOPS_DIR)\"

ifeq (y,$(CONFIG_WORKFLOW_MAKE_CMD_OVERRIDE))
WORKFLOW_MAKE_CMD:=$(subst ",,$(CONFIG_WORKFLOW_MAKE_CMD))
endif

ifeq (y,$(CONFIG_WORKFLOW_INFER_USER_AND_GROUP))
WORKFLOW_ARGS	+= infer_uid_and_group=True
else
WORKFLOW_DATA_USER:=$(subst ",,$(CONFIG_WORKFLOW_DATA_USER))
WORKFLOW_DATA_GROUP:=$(subst ",,$(CONFIG_WORKFLOW_DATA_GROUP))

WORKFLOW_ARGS	+= data_user=$(WORKFLOW_DATA_USER)
WORKFLOW_ARGS	+= data_group=$(WORKFLOW_DATA_GROUP)

endif # CONFIG_WORKFLOW_MAKE_CMD_OVERRIDE == y

BOOTLINUX_ARGS	:=
ifeq (y,$(CONFIG_BOOTLINUX))
include workflows/linux/Makefile
endif # CONFIG_BOOTLINUX == y

KDEVOPS_WORKFLOW_FSTESTS_CLEAN :=

ifeq (y,$(CONFIG_KDEVOPS_WORKFLOW_ENABLE_FSTESTS))
include workflows/fstests/Makefile
endif # CONFIG_KDEVOPS_WORKFLOW_ENABLE_FSTESTS == y

ifeq (y,$(CONFIG_KDEVOPS_WORKFLOW_ENABLE_BLKTESTS))
include workflows/blktests/Makefile
endif # CONFIG_KDEVOPS_WORKFLOW_ENABLE_BLKTESTS == y

ifeq (y,$(CONFIG_WORKFLOWS_REBOOT_LIMIT))
include workflows/demos/reboot-limit/Makefile
endif # CONFIG_WORKFLOWS_REBOOT_LIMIT == y
